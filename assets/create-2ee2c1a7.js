import{G as K,O as W,s as H,r as a,j as e,k as Be,n as B,l as Ve,d as T,a as A,o as $e}from"./index-e267a7dd.js";import{I as c}from"./input-17cf5bfb.js";import{e as qe,f as De,g as Re,b as ze}from"./index.esm-8cb1fc4b.js";import{b as Ze,c as We,T as Fe,d as Te,e as Ae,g as Pe,h as Oe,L as He,a as Ue,i as Ke}from"./index.esm-4dfd1330.js";import{a as Ye}from"./index.esm-daa111ac.js";import{B as ue}from"./button-21a5ed99.js";import{B as S}from"./combobox-940fce81.js";function ke(n){return K({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M13.003 7.754a.75.75 0 0 1 .75-.75h5.232a.75.75 0 0 1 .53 1.28l-2.776 2.777c.55.097 1.057.253 1.492.483.905.477 1.504 1.284 1.504 2.418 0 .966-.471 1.75-1.172 2.27-.687.511-1.587.77-2.521.77-1.367 0-2.274-.528-2.667-.756a.75.75 0 0 1 .755-1.297c.331.193.953.553 1.912.553.673 0 1.243-.188 1.627-.473.37-.275.566-.635.566-1.067 0-.5-.219-.836-.703-1.091-.538-.284-1.375-.443-2.471-.443a.75.75 0 0 1-.53-1.28l2.643-2.644h-3.421a.75.75 0 0 1-.75-.75ZM7.88 15.215a1.4 1.4 0 0 0-1.446.83.75.75 0 0 1-1.37-.61 2.899 2.899 0 0 1 2.986-1.71c.589.06 1.139.323 1.557.743.434.446.685 1.058.685 1.778 0 1.641-1.254 2.437-2.12 2.986-.538.341-1.18.694-1.495 1.273H9.75a.75.75 0 0 1 0 1.5h-4a.75.75 0 0 1-.75-.75c0-1.799 1.337-2.63 2.243-3.21 1.032-.659 1.55-1.031 1.55-1.8 0-.355-.116-.584-.26-.732a1.071 1.071 0 0 0-.652-.298Zm.234-13.121a.75.75 0 0 1 .386.656V9h1.252a.75.75 0 0 1 0 1.5H5.75a.75.75 0 0 1 0-1.5H7V4.103l-.853.533a.749.749 0 1 1-.795-1.272l2-1.25a.749.749 0 0 1 .762-.02Z"}}]})(n)}function Qe(n){return K({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M6.25 12a.75.75 0 0 0 0 1.5h.5a.75.75 0 0 0 0-1.5h-.5ZM5.5 9.25a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75ZM6.25 5a.75.75 0 0 0 0 1.5h.5a.75.75 0 0 0 0-1.5h-.5ZM9 12.75a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75Zm.75-4.25a.75.75 0 0 0 0 1.5h.5a.75.75 0 0 0 0-1.5h-.5ZM9 5.75A.75.75 0 0 1 9.75 5h.5a.75.75 0 0 1 0 1.5h-.5A.75.75 0 0 1 9 5.75ZM13.25 12a.75.75 0 0 0 0 1.5h.5a.75.75 0 0 0 0-1.5h-.5Zm-.75-2.75a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 0 1.5h-.5a.75.75 0 0 1-.75-.75ZM13.25 5a.75.75 0 0 0 0 1.5h.5a.75.75 0 0 0 0-1.5h-.5Z"}},{tag:"path",attr:{d:"M2 20V3a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v17c0 .173-.022.34-.063.5H20a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.2-.4l-.5-.375a.75.75 0 0 1 .9-1.2l.5.375c.504.378.8.97.8 1.6v8a2 2 0 0 1-2 2h-3.562a.767.767 0 0 1-.166-.018c-.089.012-.18.018-.272.018h-3.75a.75.75 0 0 1-.75-.75V19h-3v2.25a.75.75 0 0 1-.75.75H4a2 2 0 0 1-2-2Zm2 .5h3v-2.25a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 .75.75v2.25h3a.5.5 0 0 0 .5-.5V3a.5.5 0 0 0-.5-.5H4a.5.5 0 0 0-.5.5v17a.5.5 0 0 0 .5.5Z"}}]})(n)}function Je(n){return K({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M3 8v11c0 2.201 1.794 3 3 3h15v-2H6.012C5.55 19.988 5 19.806 5 19c0-.101.009-.191.024-.273.112-.576.584-.717.988-.727H21V4c0-1.103-.897-2-2-2H6c-1.206 0-3 .799-3 3v3zm3-4h13v12H5V5c0-.806.55-.988 1-1z"}},{tag:"path",attr:{d:"M11 14h2v-3h3V9h-3V6h-2v3H8v2h3z"}}]})(n)}const Xe=new W(H);function ea(){const[n,s]=a.useState({companyname:"",contactnumber:"",emailaddress:"",licencenumber:"",binnumber:"",managingdirector:"",tinnumber:""}),l=o=>{const{name:_,value:v}=o.target;s(d=>({...d,[_]:v}))},D=["Bidder","Broker","Association","Viewer","Warehouse","Factory",,"Teaboard"],[C,E]=a.useState(),m=async()=>{const{companyname:o,contactnumber:_,emailaddress:v,licencenumber:d,binnumber:h,managingdirector:y,tinnumber:f}=n,P={Company_name:o,Managing_director:y,Email_address:v,Contact_number:_,Bin_number:h,Tin_number:f,Licence_number:d,Account_type:C};try{await Xe.collection("profiles").create(P),window.location.reload()}catch{throw new Error}},x=o=>{o.preventDefault(),B.promise(m(),{loading:"Verifying login credential...",success:e.jsx("b",{children:"Success! You've created a new profile"}),error:e.jsx("b",{children:"Failed! Something went wrong"})})};return e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:x,className:"mx-auto shadow sm:p-8 p-4 rounded-lg",children:[e.jsx(c,{handle_input_change:l,icon:Qe,title:"Company name",type:"text",placeholder:"Company name here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:l,icon:qe,title:"Managing director",type:"text",placeholder:"Managing director name here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:l,icon:Ze,title:"Bin number",type:"number",placeholder:"Bin number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:l,icon:Be,title:"Tin number",type:"text",placeholder:"Tin number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:l,icon:Ye,title:"Licence number",type:"text",placeholder:"Licence number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:l,icon:We,title:"Contact number",type:"text",placeholder:"Contact number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:l,icon:De,title:"Email address",type:"text",placeholder:"Email address here..."}),e.jsx("div",{className:"h-2"}),e.jsx("p",{className:"mb-2",children:"Select Account Type"}),e.jsx(S,{selected:C,data:D,change:E}),e.jsx("div",{className:"h-3"}),e.jsx(ue,{type:"submit",name:"Create Profile",icon:Je})]})})}const Ce=new W(H);Ce.autoCancellation(!1);function aa(){const[n,s]=a.useState([]),[l,D]=a.useState([]);a.useEffect(()=>{(async()=>{const d=await Ce.collection("profiles").getFullList({sort:"-created"}),h=d.map(f=>f.Company_name);s(h);const y=d.map(f=>({id:f.id,name:f.Company_name}));D(y)})()},[]);const[C,E]=a.useState({username:"",password:""}),m=d=>{const{name:h,value:y}=d.target;E(f=>({...f,[h]:y}))},[x,o]=a.useState(),_=async()=>{if(x===void 0)B.error("Please pick a reference account");else{const{username:d,password:h}=C;let y="";l.map(P=>{P.name===x&&(y=P.id)});const f={username:d,password:h,passwordConfirm:h,reference:y};try{await Ce.collection("users").create(f),window.location.reload()}catch{throw new Error}}},v=d=>{d.preventDefault(),B.promise(_(),{loading:"Data processing is underway",success:e.jsx("b",{children:"Success! You've created a new profile"}),error:e.jsx("b",{children:"Failed! Something went wrong"})})};return e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:v,className:"mx-auto shadow sm:p-8 p-4 rounded-lg",children:[e.jsx(c,{handle_input_change:m,icon:De,title:"Username",type:"text",placeholder:"Username here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:m,icon:Re,title:"Password",type:"password",placeholder:"Password here..."}),e.jsx("div",{className:"h-2"}),e.jsx("p",{className:"mb-2",children:"Select Reference Account"}),e.jsx(S,{selected:x,data:n,change:o}),e.jsx("div",{className:"h-3"}),e.jsx(ue,{type:"submit",name:"Create Profile",icon:Ve})]})})}new W(H);function ta(){a.useState({username:"",password:"",managingdirector:"",licencenumber:"",emailaddress:"",contactnumber:"",binnumber:"",tinnumber:"",companyname:""}),a.useState(!1),a.useState([]),a.useState("");const n=[{name:"Profile",content:e.jsx(ea,{})},{name:"Auth Profile",content:e.jsx(aa,{})}];return e.jsx("div",{className:"sm:mt-12 p-4",children:e.jsx(Fe,{tabsData:n})})}function Ge(n){return K({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"title",attr:{},child:[]},{tag:"path",attr:{d:"M2.48 0a1.55 1.55 0 1 0 0 3.1 1.55 1.55 0 0 0 0-3.1zm19.04 0a1.55 1.55 0 1 0 0 3.101 1.55 1.55 0 0 0 0-3.101zM12 2.295a1.55 1.55 0 1 0 0 3.1 1.55 1.55 0 0 0 0-3.1zM2.48 5.272a2.48 2.48 0 1 0 0 4.96 2.48 2.48 0 0 0 0-4.96zm19.04 0a2.48 2.48 0 1 0 0 4.96 2.48 2.48 0 0 0 0-4.96zM12 8.496a1.55 1.55 0 1 0 0 3.1 1.55 1.55 0 0 0 0-3.1zm-9.52 3.907a1.55 1.55 0 1 0 0 3.1 1.55 1.55 0 0 0 0-3.1zm19.04 0a1.55 1.55 0 1 0 0 3.102 1.55 1.55 0 0 0 0-3.102zM12 13.767a2.48 2.48 0 1 0 0 4.962 2.48 2.48 0 0 0 0-4.962zm-9.52 3.907a2.48 2.48 0 1 0 .001 4.962 2.48 2.48 0 0 0 0-4.962zm19.04.93a1.55 1.55 0 1 0 0 3.102 1.55 1.55 0 0 0 0-3.101zM12 20.9a1.55 1.55 0 1 0 0 3.1 1.55 1.55 0 0 0 0-3.1Z"}}]})(n)}function sa(n){return K({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"g",attr:{id:"View_Timeline"},child:[{tag:"g",attr:{},child:[{tag:"path",attr:{d:"M18.436,20.94H5.562a2.5,2.5,0,0,1-2.5-2.5V5.567a2.5,2.5,0,0,1,2.5-2.5H18.436a2.5,2.5,0,0,1,2.5,2.5V18.44A2.5,2.5,0,0,1,18.436,20.94ZM5.562,4.067a1.5,1.5,0,0,0-1.5,1.5V18.44a1.5,1.5,0,0,0,1.5,1.5H18.436a1.5,1.5,0,0,0,1.5-1.5V5.567a1.5,1.5,0,0,0-1.5-1.5Z"}},{tag:"path",attr:{d:"M6.544,8.287h0a.5.5,0,0,1,0-1H12a.5.5,0,0,1,0,1Z"}},{tag:"path",attr:{d:"M9.271,12.5h0a.5.5,0,0,1,0-1h5.454a.5.5,0,0,1,0,1Z"}},{tag:"path",attr:{d:"M12,16.724h0a.5.5,0,0,1,0-1h5.455a.5.5,0,0,1,0,1Z"}}]}]}]})(n)}function Ie(n){return K({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M8.61 3l5.74 1.53L15 5v6.74l-.37.48-6.13 1.69-6.14-1.69-.36-.48V5l.61-.47L8.34 3h.27zm-.09 1l-4 1 .55.2 3.43.9 3-.81.95-.29-3.93-1zM3 11.36l5 1.37V7L3 5.66v5.7zM9 7v5.73l5-1.37V5.63l-2.02.553V8.75l-1 .26V6.457L9 7z"}}]})(n)}const ee=new W(H);ee.autoCancellation(!1);function ra(){const[n,s]=a.useState([]),[l,D]=a.useState(),[C,E]=a.useState(),[m,x]=a.useState(0),[o,_]=a.useState(0),[v,d]=a.useState(0),[h,y]=a.useState(),[f,P]=a.useState([]),[Y,me]=a.useState(),[ae,he]=a.useState(["BOP","BOP (S) (C)","BOP (C)","GBOP","GBOP (S) (C)","GBOP (C)","GOF","GOF (S) (C)","GOF (C)","OF","OF (S) (C)","OF (C)","FOF","FOF (S) (C)","FOF (C)","PF","PF (S) (C)","PF (C)","RD","RD (S) (C)","RD (C)","CD","CD (S) (C)","CD (C)"]),[q,ve]=a.useState(),[Q,te]=a.useState(),[J,Ne]=a.useState(),[R,pe]=a.useState(["DUST","LEAF","SUPPLEMENT"]),[V,xe]=a.useState(),[se,re]=a.useState([]),[ne,fe]=a.useState(),[Le,ge]=a.useState([]),[X,_e]=a.useState(!1),[ye,je]=a.useState(),[p,Se]=a.useState({}),j=r=>{const{name:I,value:g}=r.target;Se(z=>({...z,[I]:g}))};a.useEffect(()=>{p.package!==void 0&&p.netweight!==void 0&&x(p.package*p.netweight)},[p]),a.useEffect(()=>{_(m-v)},[m]),a.useEffect(()=>{_(m-v)},[v]),a.useEffect(()=>{V==="LEAF"?d(1.5):V==="DUST"?d(.8):V==="SUPPLEMENT"&&d(.5)},[V]),a.useEffect(()=>{(async()=>{const r=await ee.collection("profiles").getFullList({sort:"-created"});D(r);const I=[],g=[];T(`${A}`,"factories").map((L,G)=>{I.push(L.Company_name)}),s(I),T(`${A}`,"warehouses").map((L,G)=>{g.push(L.Company_name)}),P(g);const O=await ee.collection("rating").getFullList();E(O);const b=[],w=[];T(`${A}`,"leafs").map((L,G)=>{b.push(L.Name)}),re(b),T(`${A}`,"liquors").map((L,G)=>{w.push(L.Name)}),ge(w);const i=new Date().getFullYear(),N=i+1,k=[];k.push(`${i} ${N}`),te(k),Ne(k[0])})()},[]);const be=()=>{if(!X){_e(!0);let r=null,I=null,g=null,z=null;T(`${A}`,"factories").map((i,N)=>{i.Company_name===h&&(I=i.id)}),T(`${A}`,"warehouses").map((i,N)=>{i.Company_name===Y&&(r=i.id)}),T(`${A}`,"leafs").map((i,N)=>{i.Name===ne&&(g=i.id)}),T(`${A}`,"liquors").map((i,N)=>{i.Name===ye&&(z=i.id)});const F=p.season?p.season:`${Q[0]}`;console.log(F);const $={Sale_number:parseInt(p.salenumber),Lot_number:parseInt(p.lotnumber),Invoice:p.invoicenumber,Total_kg:parseInt(m),Grand_total:parseFloat(o),Offer_price:parseInt(p.offerprice),Category:V,Grade:q,brokersID:ee.authStore.model.id,Factory:I,Liquor_rating:z,Warehose:r,Leaf_rating:g,Season:F,Gross_weight:parseFloat(p.grossweight),Net_weight:parseInt(p.netweight),Collection:parseFloat(v),Package:parseInt(p.package)};try{(async()=>(await ee.collection("catalog").create($),B.success("Catalog created successfully!"),window.location.reload()))()}catch(i){B.error(i)}}},ce=r=>{r.preventDefault(),be()},oe=r=>{r.keyCode===13&&r.preventDefault()};return e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:ce,onKeyDown:oe,className:"mx-auto shadow sm:p-8 p-4 rounded-lg",children:[e.jsx(c,{handle_input_change:j,icon:ke,title:"Sale number",type:"number",placeholder:"Sale number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:j,icon:Te,title:"Lot number",type:"number",placeholder:"Lot number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:j,icon:Ae,title:"Invoice number",type:"text",placeholder:"Invoice number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:j,icon:Ge,title:"Gross weight",type:"text",placeholder:"Gross weight here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:j,icon:Pe,title:"Net weight",type:"number",placeholder:"Net weight here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:j,icon:Ie,title:"Package",type:"number",placeholder:"Package here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{defaultValue:Q,handle_input_change:j,icon:sa,title:"Season",type:"text",placeholder:"Season e.g. 2022 2023"}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:j,icon:Oe,title:"Offer price",type:"number",placeholder:"Offer price here..."}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Leaf Rating"}),e.jsx(S,{selected:ne,data:se,change:fe}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Liquor Rating"}),e.jsx(S,{selected:ye,data:Le,change:je}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Factory "}),e.jsx(S,{selected:h,data:n,change:y}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Warehouse"}),e.jsx(S,{selected:Y,data:f,change:me}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Grade"}),e.jsx(S,{selected:q,data:ae,change:ve}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Category"}),e.jsx(S,{selected:V,data:R,change:xe}),e.jsx("div",{className:"h-3"}),e.jsxs("div",{className:"flex items-center justify-around",children:[e.jsxs("p",{children:["Total KG: ",e.jsx("span",{className:"font-semibold text-black/50",children:m})]}),e.jsxs("p",{children:["Grand Total: ",e.jsx("span",{className:"font-semibold text-black/50",children:o})]}),e.jsxs("p",{children:["Collection: ",e.jsx("span",{className:"font-semibold text-black/50",children:v})]})]}),e.jsx("div",{className:"h-3"}),e.jsx(ue,{type:"submit",name:"Create Catalog",icon:$e})]})})}const M=new W(H);M.autoCancellation(!1);function na({click:n,data:s}){const[l,D]=a.useState([]),[C,E]=a.useState(),[m,x]=a.useState(),[o,_]=a.useState(0),[v,d]=a.useState(0),[h,y]=a.useState(0),[f,P]=a.useState(),[Y,me]=a.useState([]),[ae,he]=a.useState(),[q,ve]=a.useState(["BOP","BOP (S) (C)","BOP (C)","GBOP","GBOP (S) (C)","GBOP (C)","GOF","GOF (S) (C)","GOF (C)","OF","OF (S) (C)","OF (C)","FOF","FOF (S) (C)","FOF (C)","PF","PF (S) (C)","PF (C)","RD","RD (S) (C)","RD (C)","CD","CD (S) (C)","CD (C)"]),[Q,te]=a.useState(q[0]);a.useState(),a.useState();const[J,Ne]=a.useState(["DUST","LEAF","SUPPLEMENT"]),[R,pe]=a.useState(J[0]),[V,xe]=a.useState([]),[se,re]=a.useState(),[ne,fe]=a.useState([]),[Le,ge]=a.useState([]),[X,_e]=a.useState(),[ye,je]=a.useState(),[p,Se]=a.useState([]),[j,be]=a.useState(),[ce,oe]=a.useState(),[r,I]=a.useState({}),g=O=>{const{name:b,value:w}=O.target;I(F=>({...F,[b]:w}))};a.useEffect(()=>{(async()=>{const O=await M.collection("rating").getFullList();x(O);const b=[],w=[];let F=null,$=null;O.map((t,u)=>{t.Type==="Leaf"&&b.push(t.Name),t.Type==="Leaf"&&t.id===s.Leaf_rating&&(F=t.Name),t.Type==="Liquor"&&w.push(t.Name),t.Type==="Liquor"&&t.id===s.Liquor_rating&&($=t.Name)}),xe(b),b.map((t,u)=>{t===F&&re(b[u])}),w.map((t,u)=>{t===$&&oe(w[u])}),fe(w);const i=await M.collection("profiles").getFullList({sort:"-created"});E(i);const N=[],k=[];let L,G;i.map((t,u)=>{t.Account_type==="Factory"&&N.push(t.Company_name),t.Account_type==="Factory"&&t.id===s.Factory&&(L=t.Company_name),t.Account_type==="Warehouse"&&k.push(t.Company_name),t.Account_type==="Warehouse"&&t.id===s.Warehose&&(G=t.Company_name)}),D(N),me(k),N.map((t,u)=>{t===L&&P(N[u])}),k.map((t,u)=>{t===G&&he(k[u])}),J.map((t,u)=>{t===s.Category&&pe(J[u])}),q.map((t,u)=>{t===s.Grade&&te(q[u])}),_(s.Package*s.Net_weight);const Z=await M.collection("users").getFullList({sort:"-created"});Se(Z);let ie=[];Z.map(t=>{ie.push(t.username)}),ge(ie);const U=await M.collection("auction_info").getFirstListItem(`catalog="${s.id}"`);U&&(be(U),je(U.price_max)),Z.map(t=>{t.id===U.bidder_current&&_e(t.username)})})()},[]),a.useEffect(()=>{y(R==="LEAF"?1.5:R==="DUST"?.8:.5)},[R]),a.useEffect(()=>{r.package!==void 0&&r.netweight!==void 0&&_(r.package*r.netweight)},[r]),a.useEffect(()=>{d(o-h)},[o]),a.useEffect(()=>{d(o-h)},[h]);const z=async()=>{new Date().getFullYear();let b=null,w=null,F=null,$=null;C.map(t=>{t.Account_type==="Factory"&&f===t.Company_name?w=t.id:t.Account_type==="Warehouse"&&ae===t.Company_name&&(b=t.id)}),m.map(t=>{t.Name===se?F=t.id:t.Name===ce&&($=t.id)});let i=r.salenumber?r.salenumber:s.Sale_number,N=r.lotnumber?r.lotnumber:s.Lot_number,k=r.invoicenumber?r.invoicenumber:s.Invoice,L=r.grossweight?r.grossweight:s.Gross_weight,G=r.netweight?r.netweight:s.Net_weight,Z=r.package?r.package:s.Package,ie=r.offerprice?r.offerprice:s.Offer_price;const U={Sale_number:i,Lot_number:N,Invoice:k,Offer_price:ie,Category:R,Grade:Q,brokersID:M.authStore.model.id,Factory:w,Liquor_rating:$,Warehose:b,Leaf_rating:F,Gross_weight:L,Net_weight:G,Collection:h,Package:Z,Total_kg:G*Z,Grand_total:G*Z-h};try{if(await M.collection("catalog").update(`${s.id}`,U),r.maxbid||X)if(j){let t="";p.map(de=>{de.username===X&&(t=de.id)});let u=[];u=j.bidders,j.bidders.map(de=>{de!==t&&u.push(t)});const le={price_max:r.maxbid?r.maxbid:j.price_max,bidders:u,bidder_current:t,Status:!0},ua=await M.collection("auction_info").update(`${j.id}`,le);setTimeout(()=>{window.location.reload()},1e3)}else{let t="";p.map(le=>{le.username===X&&(t=le.id)});const u={catalog:s.id,price_max:r.maxbid,bidders:[`${t}`],bidder_current:t,Status:!0},Me=await M.collection("auction_info").create(u);setTimeout(()=>{window.location.reload()},1e3)}}catch{throw new Error}},we=O=>{O.preventDefault(),B.promise(z(),{loading:"Please wait...",success:e.jsx("b",{children:"Catalog updated!"}),error:e.jsx("b",{children:"Something went wrong!"})})};return e.jsx("div",{className:"p-4  bg-white z-50 w-screen h-screen overflow-y-scroll fixed inset-0",children:e.jsxs("form",{onSubmit:we,className:"mx-auto max-w-md shadow sm:p-8 p-4 rounded-lg",children:[e.jsx("div",{onClick:n,className:"cursor-pointer hover:bg-black/80 duration-300 text-2xl right-4 sm:right-10 bg-black text-white p-4 rounded-lg z-50 md:right-24 md:text-4xl fixed",children:e.jsx(He,{})}),e.jsx(c,{handle_input_change:g,icon:ke,title:"Sale number",defaultValue:s.Sale_number,type:"number",placeholder:"Sale number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:g,icon:Te,title:"Lot number",type:"number",defaultValue:s.Lot_number,placeholder:"Lot number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:g,icon:Ae,defaultValue:s.Invoice,title:"Invoice number",type:"text",placeholder:"Invoice number here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:g,icon:Ge,title:"Gross weight",defaultValue:s.Gross_weight,type:"number",placeholder:"Gross weight here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:g,icon:Pe,title:"Net weight",type:"number",defaultValue:s.Net_weight,placeholder:"Net weight here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:g,icon:Ie,title:"Package",type:"number",defaultValue:s.Package,placeholder:"Package here..."}),e.jsx("div",{className:"h-2"}),e.jsx(c,{handle_input_change:g,icon:Oe,defaultValue:s.Offer_price,title:"Offer price",type:"number",placeholder:"Offer price here..."}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Leaf Rating"}),e.jsx(S,{selected:se,data:V,change:re}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Liquor Rating"}),e.jsx(S,{selected:ce,data:ne,change:oe}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Factory "}),e.jsx(S,{selected:f,data:l,change:P}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Warehouse"}),e.jsx(S,{selected:ae,data:Y,change:he}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Grade"}),e.jsx(S,{selected:Q,data:q,change:te}),e.jsx("div",{className:"h-3"}),e.jsx("p",{className:"mb-2",children:"Category"}),e.jsx(S,{selected:R,data:J,change:pe}),e.jsx("div",{className:"h-3"}),e.jsx("div",{className:"h-3"}),e.jsx(ue,{type:"submit",name:"Update Catalog",icon:ze})]})})}const ca=new W(H);function oa({data:n}){const[s,l]=a.useState(!1);function D(o,_){return o.length<=_?o:o.substring(0,_)+"..."}const C=()=>{l(!s)},E=async()=>{try{await ca.collection("catalog").delete(`${n.id}`),window.location.reload()}catch(o){throw console.log(o),new o}},m=()=>{B(o=>e.jsxs("span",{children:[e.jsx("span",{className:"text-black font-semibold",children:"Are you sure? "}),e.jsx("button",{className:"ml-2 px-6 py-2 text-white rounded-lg bg-red-500",onClick:()=>{B.dismiss(o.id),B.promise(E(),{loading:"Please wait...",success:e.jsx("b",{children:"Deleted successfully!"}),error:e.jsx("b",{children:"Something went wrong!"})})},children:"Delete"})]}))},x=s?"":"hidden";return e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:n.Sale_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:n.Lot_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:D(n.Invoice,10)}),e.jsxs("td",{className:"flex justify-center",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap flex items-center justify-center text-sm font-medium",children:e.jsx("a",{onClick:C,className:"text-black hover:text-black/50",href:"#",children:e.jsx(Ue,{})})}),e.jsx("td",{className:"px-4 py-4 whitespace-nowrap flex items-center justify-center text-sm font-medium",children:e.jsx("a",{onClick:m,className:"text-red-500 hover:text-red-500",href:"#",children:e.jsx(Ke,{})})})]})]}),e.jsx("div",{className:`${x}`,children:e.jsx(na,{click:C,data:n})})]})}const Ee=new W(H);Ee.autoCancellation(!1);function ia(){const[n,s]=a.useState([]);return a.useEffect(()=>{(async()=>{const l=Ee.authStore.model.id,D=T(`${A}`,"catalogs"),C=T(`${A}`,"profile"),E=[],m=await Ee.collection("Eligibility").getFullList({sort:"-created"});D.map(x=>{x.brokersID===l&&x.Season===m[0].Season&&x.Sale_number===parseInt(m[0].Sale_Number)&&C[0].id===m[0].Profile&&E.push(x)}),s(E)})()},[]),e.jsxs("div",{className:"shadow-md bg-white rounded-lg h-fit m-4",children:[e.jsx("div",{className:"py-3 px-6 border-b border-dashed",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h4",{className:"text-lg font-semibold tracking-tight text-slate-900",children:"Your catalog"})})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-full inline-block align-middle",children:e.jsx("div",{className:"border rounded-lg shadow-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Sale Num."}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lot Num."}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Edit/Delete"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:n.map(l=>e.jsx(oa,{data:l}))})]})})})})})]})}const la=[{name:"Create",content:e.jsx(ra,{})},{name:"Edit",content:e.jsx(ia,{})}];function da(){return e.jsx("div",{className:"sm:mt-2",children:e.jsx(Fe,{tabsData:la})})}function ya(){const[n,s]=a.useState("");return a.useEffect(()=>{const l=T(`${A}`,"profile");s(l[0].Account_type)},[]),e.jsxs(e.Fragment,{children:[n==="Association"?e.jsx(ta,{}):null,n==="Broker"?e.jsx(da,{}):null]})}export{ya as default};
