import{O as _,s as b,r as s,d as g,a as j,j as e,B as k,n as $}from"./index-e267a7dd.js";import{I as D}from"./input-17cf5bfb.js";import{M as T,c as I}from"./index.esm-8cb1fc4b.js";import{B as G}from"./combobox-940fce81.js";const E=new _(b);function B({data:t,statusSELECTED:l}){const[n,o]=s.useState(""),[N,y]=s.useState(""),[i,p]=s.useState(""),[x,m]=s.useState(!1),[d,u]=s.useState(!0),[w,f]=s.useState("");return s.useEffect(()=>{g(`${j}`,"factories").map(a=>{a.id===t.Factory&&o(a.Company_name)});const r=g(`${j}`,"warehouses");r&&r.map(a=>{a.id===t.Warehose&&y(a.Company_name)}),(async()=>{const a=await E.collection("auction_info").getFirstListItem(`catalog="${t.id}"`,{expand:"relField1,relField2.subRelField"});if(a)if(a.bidder_current===E.authStore.model.id&&a.Status===l){u(!1),m(a.Status),p(a.price_max);const h=await E.collection("users").getFirstListItem(`id="${a.bidder_current}"`);h&&f(h.username)}else u(!0)})()},[l]),e.jsx(e.Fragment,{children:d?null:e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Lot_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Invoice}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:n}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Grade}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Net_weight}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Package}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Total_kg}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Grand_total}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Offer_price}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Collection}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Gross_weight}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Season}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:N}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Category}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:i}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:x?e.jsx("div",{className:"text-green-500 text-xl",children:e.jsx(k,{})}):e.jsx("div",{className:"text-red-500 text-xl",children:e.jsx(T,{})})})]})," "]})})}function O({catalog:t,set_all_lot:l,statusSELECTED:n}){return e.jsx("div",{className:"mt-12",children:e.jsxs("div",{className:"shadow-md w-[80vw] mx-auto bg-white rounded-lg h-fit",children:[e.jsx("div",{className:"py-3 px-6 border-b border-dashed",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h4",{className:"text-lg font-semibold tracking-tight text-slate-900",children:"Report"})})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-full inline-block align-middle",children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lot "}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Factory"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Grade"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Net weight"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Pkg"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Grand Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Offer price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Collection"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Gross weight"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Season"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Warehouse"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Price max"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(o=>e.jsx(B,{data:o,statusSELECTED:n}))})]})})})})})]})})}const C=new _(b);C.autoCancellation(!1);function R(){const[t,l]=s.useState([]),[n,o]=s.useState([]),[N,y]=s.useState(!1),[i,p]=s.useState(),[x,m]=s.useState(),[d,u]=s.useState(!0),w=c=>{const r=c.target.value==="true";u(r)};s.useEffect(()=>{(async()=>{try{const c=g(`${j}`,"catalogs"),r=[...new Set(c.map(h=>h.Season))];l(r);const a=await C.collection("Eligibility").getFullList();p(a[0].Season),m(a[0].Sale_Number)}catch(c){$.error(c.message)}})()},[]),s.useEffect(()=>{(async()=>{const c=await C.collection("catalog").getFullList({sort:"+created"});let r=[];c.map(a=>{a.Season===i&&a.Sale_number===parseInt(x)&&r.push(a)}),o(r)})()},[i,x,d]);const f=c=>{m(c.target.value)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex mt-6 justify-between items-center p-4 sm:w-[600px] mx-auto",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("p",{className:"mb-2",children:"Select season"}),e.jsx(G,{selected:i,data:t,change:p})]}),e.jsx("div",{className:"w-2"}),e.jsx("div",{className:"w-1/2",children:e.jsx(D,{title:"Sale Number",type:"number",defaultValue:x,placeholder:"Sale number here...",handle_input_change:f,icon:I})}),e.jsx("div",{className:"w-2"}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("p",{className:"mb-2",children:"Status"}),e.jsxs("select",{className:"block w-full p-4 text-black placeholder-gray-500 transition-all duration-200 bg-white border border-gray-200 rounded-md focus:outline-none focus:border-black caret-black",id:"myDropdown",value:d.toString(),onChange:w,children:[e.jsx("option",{value:"true",children:"Sold"}),e.jsx("option",{value:"false",children:"Unsold"})]})]})]}),e.jsx(O,{set_all_lot:y,catalog:n,statusSELECTED:d}),e.jsx("br",{})]})}const L=new _(b);L.autoCancellation(!1);function A({data:t,statusSELECTED:l}){const[n,o]=s.useState(""),[N,y]=s.useState(""),[i,p]=s.useState(""),[x,m]=s.useState(!1),[d,u]=s.useState(!0),[w,f]=s.useState("");return s.useEffect(()=>{g(`${j}`,"factories").map(a=>{a.id===t.Factory&&o(a.Company_name)});const r=g(`${j}`,"warehouses");r&&r.map(a=>{a.id===t.Warehose&&y(a.Company_name)}),(async()=>{const a=await L.collection("auction_info").getFirstListItem(`catalog="${t.id}"`,{expand:"relField1,relField2.subRelField"});if(a)if(a.Status===l){u(!1),m(a.Status),p(a.price_max);const h=await L.collection("users").getFirstListItem(`id="${a.bidder_current}"`);h&&f(h.username)}else u(!0)})()},[l]),e.jsx(e.Fragment,{children:d?null:e.jsxs(e.Fragment,{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Lot_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Invoice}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:n}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Grade}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:t.Net_weight}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Package}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Total_kg}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Grand_total}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Offer_price}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Collection}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Gross_weight}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Season}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:N}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:t.Category}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:w}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:i}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:x?e.jsx("div",{className:"text-green-500 text-xl",children:e.jsx(k,{})}):e.jsx("div",{className:"text-red-500 text-xl",children:e.jsx(T,{})})})]})," "]})})}function P({catalog:t,set_all_lot:l,statusSELECTED:n}){return e.jsx("div",{className:"mt-12",children:e.jsxs("div",{className:"shadow-md w-[80vw] mx-auto bg-white rounded-lg h-fit",children:[e.jsx("div",{className:"py-3 px-6 border-b border-dashed",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h4",{className:"text-lg font-semibold tracking-tight text-slate-900",children:"Report"})})}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("div",{className:"min-w-full inline-block align-middle",children:e.jsx("div",{className:"overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Lot "}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Invoice"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Factory"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Grade"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Net weight"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Pkg"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Grand Total"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Offer price"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Collection"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Gross weight"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Season"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Warehouse"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Current bidder"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Price max"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-end text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map(o=>e.jsx(A,{data:o,statusSELECTED:n}))})]})})})})})]})})}const S=new _(b);S.autoCancellation(!1);function q(){s.useState(),s.useState([]);const[t,l]=s.useState([]);s.useState(""),s.useState(!1);const[n,o]=s.useState([]);s.useState([]);const[N,y]=s.useState(!1);s.useState(0),s.useState(),s.useState(),s.useState(!1),s.useState(!1);const[i,p]=s.useState(),[x,m]=s.useState(),[d,u]=s.useState(!0),w=c=>{const r=c.target.value==="true";u(r)};s.useEffect(()=>{(async()=>{try{const c=await S.collection("profiles").getFullList({sort:"-created",filter:'Account_type="Broker"'}),r=g(`${j}`,"catalogs"),a=[...new Set(r.map(v=>v.Season))],h=[...new Set(r.map(v=>v.Sale_number))];l(a);const F=await S.collection("Eligibility").getFullList();p(F[0].Season),m(F[0].Sale_Number)}catch(c){$.error(c.message)}})()},[]),s.useEffect(()=>{(async()=>{const c=await S.collection("catalog").getFullList({sort:"+created",filter:`brokersID="${S.authStore.model.id}"`});let r=[];c.map(a=>{a.Season===i&&a.Sale_number===parseInt(x)&&r.push(a)}),o(r)})()},[i,x,d]);const f=c=>{m(c.target.value)};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex mt-6 justify-between items-center p-4 sm:w-[600px] mx-auto",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx("p",{className:"mb-2",children:"Select season"}),e.jsx(G,{selected:i,data:t,change:p})]}),e.jsx("div",{className:"w-2"}),e.jsx("div",{className:"w-1/2",children:e.jsx(D,{title:"Sale Number",type:"number",defaultValue:x,placeholder:"Sale number here...",handle_input_change:f,icon:I})}),e.jsx("div",{className:"w-2"}),e.jsxs("div",{className:"w-1/2",children:[e.jsx("p",{className:"mb-2",children:"Status"}),e.jsxs("select",{className:"block w-full p-4 text-black placeholder-gray-500 transition-all duration-200 bg-white border border-gray-200 rounded-md focus:outline-none focus:border-black caret-black",id:"myDropdown",value:d.toString(),onChange:w,children:[e.jsx("option",{value:"true",children:"Sold"}),e.jsx("option",{value:"false",children:"Unsold"})]}),"  "]})]}),e.jsx(P,{set_all_lot:y,catalog:n,statusSELECTED:d}),e.jsx("br",{})]})}function K(){const[t,l]=s.useState("");return s.useEffect(()=>{const n=g(`${j}`,"profile");l(n[0].Account_type)},[]),e.jsxs(e.Fragment,{children:[t==="Bidder"?e.jsx(R,{}):null,t==="Broker"?e.jsx(q,{}):null]})}export{K as default};
